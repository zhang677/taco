This is a modified version to illustrate Segment Warp and SpMM atomic parallelism in TACO.

The Tensor Algebra Compiler (taco) is a C++ library that computes
tensor algebra expressions on sparse and dense tensors.  It uses novel
compiler techniques to get performance competitive with hand-optimized
kernels in widely used libraries for both sparse tensor algebra and
sparse linear algebra.

You can use taco as a C++ library that lets you load tensors, read
tensors from files, and compute tensor expressions.  You can also use
taco as a code generator that generates C functions that compute
tensor expressions.

Learn more about taco at
[tensor-compiler.org](https://tensor-compiler.org), in the paper
[The Tensor Algebra Compiler](http://tensor-compiler.org/kjolstad-oopsla17-tensor-compiler.pdf),
or in [this talk](https://youtu.be/Kffbzf9etLE).  To learn more about
where taco is going in the near-term, see the technical reports on
[optimization](https://arxiv.org/abs/1802.10574) and
[formats](https://arxiv.org/abs/1804.10112).

You can also subscribe to the
[taco-announcements](https://lists.csail.mit.edu/mailman/listinfo/taco-announcements)
email list where we post announcements, RFCs, and notifications of API
changes, or the [taco-discuss](https://lists.csail.mit.edu/mailman/listinfo/taco-discuss)
email list for open discussions and questions.

TL;DR build taco using CMake. Run `make test`.

# Additional tests

We added tests for four SpMM algorithms in `tests-schedule-me.cpp`. Kernels generated by these four tests can't directly
run with `-DCUDA=ON`. We test the generated kernels in another code base. 

**spmm_SR_EB_N**: It generates {$<1\,nnz , c\,col>,r$}. We replace the `atomicAdd` with `segReduceGroup` by hand. When 
running this test, `ZTEST` in `lowerer_impl_imperative.h` should be set true. It should be set false when doing other 
tests. This's because TACO lowerer needs a different lowering process for this algorithm.

**spmm_SR_RB**: It generates {$<g\,row,c\,col>,1$}. 

**spmm_SR_EB**: It generates {$<g\,nnz, c\,col>,1$}.

**spmm_PR_RB**: It generates {$<\frac{1}{g}\,row, c\,col>,r$}. We change `atomicAddWarp` to `atomicAddGroup` by hand.
Besides, `break;` in the last level for-loop should be changed to `continue;` 


